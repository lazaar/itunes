{"version":3,"sources":["scripts/app-df667f7388.js"],"names":["angular","module","factory","$http","$q","$log","itunesConstantes","searchMusic","query","defered","defer","navigator","onLine","url","jsonp","encodeURI","params","callback","term","success","datas","resolve","error","status","headers","config","debug","reject","messageError","wsError","noConnection","promise","directive","$timeout","restrict","link","scope","elem","attrs","container","options","extend","itemSelector","fromJson","masonry","Masonry","debounceTimeout","update","cancel","reloadItems","layout","children","css","removeBrick","appendBricks","ele","appended","$on","master","parent","imagesLoaded","ready","MainController","searchService","validate","vm","isLoading","then","songs","errorMsg","msg","init","resultCount","this","controller","$inject","constant","routerConfig","$stateProvider","$urlRouterProvider","state","templateUrl","controllerAs","otherwise","run","$templateCache","put"],"mappings":"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","file":"scripts/app-df667f7388.js","sourcesContent":["(function() {\n  'use strict';\n\n  angular\n    .module('itunes', ['ngMessages', 'ui.router','ngCart']);\n\n})();\n\n(function(){\r\n    'use strict';\r\n    angular\r\n        .module('itunes')\r\n        .factory('searchService', function($http, $q, $log, itunesConstantes){\r\n\r\n\r\n        // ############################################# //\r\n        // ############### PUBLIC BUSINESS ############# //\r\n        // ############################################# //\r\n\r\n        /**\r\n         * Récupération du résultats\r\n         */\r\n        function searchMusic(query){\r\n                var defered = $q.defer();\r\n\r\n                /********** On vérifie la connextion internet **********/\r\n                if(navigator.onLine){\r\n                    var url = itunesConstantes.url;\r\n                    $http.jsonp(encodeURI(url), {\r\n                            params: {\r\n                                \"callback\": \"JSON_CALLBACK\",\r\n                                \"term\": query\r\n                            }\r\n                        })\r\n                        .success(function (datas) {\r\n                            // Récupération de pistes\r\n                            defered.resolve(datas);\r\n                        })\r\n                        .error(function (datas, status, headers, config) {\r\n                            $log.debug('Erreur lors de la récupération des resultats :', datas, status, headers, config);\r\n                            // Erreur WS\r\n                            defered.reject(itunesConstantes.messageError.wsError);\r\n                        });\r\n                }else {\r\n                    // Pas de connexion Internet\r\n                    defered.reject(itunesConstantes.messageError.noConnection);\r\n                }\r\n                return defered.promise;\r\n            }\r\n\r\n            return {\r\n                searchMusic : searchMusic\r\n            };\r\n        });\r\n}());\n(function() {\r\n    \"use strict\";\r\n\r\n    angular.module('itunes').directive('masonry', function($timeout) {\r\n        return {\r\n            restrict: 'AC',\r\n            link: function(scope, elem, attrs) {\r\n                var container = elem[0];\r\n                var options = angular.extend({\r\n                    itemSelector: '.item'\r\n                }, angular.fromJson(attrs.masonry));\r\n                var masonry = scope.masonry = new Masonry(container, options);\r\n\r\n                var debounceTimeout = 0;\r\n                scope.update = function() {\r\n                    if (debounceTimeout) {\r\n                        $timeout.cancel(debounceTimeout);\r\n                    }\r\n                    debounceTimeout = $timeout(function() {\r\n                        debounceTimeout = 0;\r\n\r\n                        masonry.reloadItems();\r\n                        masonry.layout();\r\n    \r\n                        elem.children(options.itemSelector).css('visibility', 'visible');\r\n                    }, 120);\r\n                };\r\n                \r\n                scope.removeBrick = function() {\r\n                    $timeout(function() {\r\n                        masonry.reloadItems();\r\n                        masonry.layout();\r\n                   }, 500);\r\n                };                \r\n                \r\n                scope.appendBricks = function(ele) {\r\n                    masonry.appended(ele);\r\n                };                \r\n                \r\n                scope.$on('masonry.layout', function() {\r\n                    masonry.layout();                 \r\n                });\r\n                \r\n                scope.update();\r\n            }\r\n        };\r\n    }).directive('masonryTile', function() {\r\n        return {\r\n            restrict: 'AC',\r\n            link: function(scope, elem) {\r\n                elem.css('visibility', 'hidden');\r\n                var master = elem.parent('*[masonry]:first').scope(),\r\n                    update = master.update,\r\n                    removeBrick = master.removeBrick,\r\n                    appendBricks = master.appendBricks;                    \r\n                if (update) {\r\n                    imagesLoaded( elem[0], update);\r\n                    elem.ready(update);\r\n                }\r\n                if (appendBricks) {\r\n                    imagesLoaded( elem[0], appendBricks(elem));\r\n                }                \r\n                scope.$on('$destroy', function() {\r\n                    if (removeBrick) {\r\n                        removeBrick();\r\n                    }\r\n                });                \r\n            }\r\n        };\r\n    });\r\n})();\n(function() {\n  'use strict';\n\n  angular\n    .module('itunes')\n    .controller('MainController', MainController);\n\n  /** @ngInject */\n  function MainController(searchService) {\n    var vm = this;\n\n    /********** Lancer la recherche des pistes **********/\n    function validate(){\n      vm.isLoading = true;\n      searchService.searchMusic(vm.query).then(function(datas){\n        vm.songs = datas ;\n        vm.errorMsg = '';\n        vm.isLoading = false;\n      },\n      function(msg){\n        vm.errorMsg = msg;\n        vm.isLoading = false;\n\n      });\n    }\n\n    /********** Constructeur **********/\n    function init() {\n      vm.validate = validate;\n      vm.errorMsg = '';\n      vm.songs = {resultCount:0}\n    }\n    \n    init();\n  }\n})();\n\n(function () {\r\n    'use strict';\r\n    /********** Fichier des constantes **********/\r\n    angular.module('itunes').constant('itunesConstantes', {\r\n        url:'https://itunes.apple.com/search',\r\n        messageError:{\r\n\t\t\tnoConnection: 'Même iTunes ne fonctionne pas en mode non connecté, Vérifiez votre connexion internet puis réessayer',\r\n\t\t\twsError\t\t: 'Oups! Une erreur est survenue. Veuillez réessayer ultèrieurement. '\r\n        }\r\n    });\r\n})();\n(function() {\n  'use strict';\n\n  angular\n    .module('itunes')\n    .config(routerConfig);\n\n  /** @ngInject */\n  function routerConfig($stateProvider, $urlRouterProvider) {\n    $stateProvider\n      .state('home', {\n        url: '/',\n        templateUrl: 'app/main/main.html',\n        controller: 'MainController',\n        controllerAs: 'vm'\n      });\n\n\n    $urlRouterProvider.otherwise('/');\n  }\n\n})();\n\nangular.module(\"itunes\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/main/main.html\",\"<div class=\\\"container\\\"><div class=\\\"jumbotron text-center\\\" ng-mouseleave=\\\"showCart=false\\\"><h1>iTunes Recherche</h1><form class=\\\"form-group\\\" name=\\\"searchForm\\\" ng-submit=\\\"searchForm.$valid && vm.validate()\\\" novalidate=\\\"\\\"><input type=\\\"text\\\" name=\\\"search\\\" ng-model=\\\"vm.query\\\" class=\\\"form-control\\\" required=\\\"\\\"><div class=\\\"form-errors\\\" ng-messages=\\\"searchForm.search.$error\\\" ng-if=\\\"searchForm.search.$invalid && searchForm.$submitted\\\"><div class=\\\"form_error\\\" ng-message=\\\"required\\\">Le vide est indispensable pour notre vie, mais pas pour une recherche :)</div></div><button type=\\\"submit\\\" class=\\\"btn btn-lg btn-success\\\" ng-disabled=\\\"vm.isLoading\\\"><span ng-show=\\\"!vm.isLoading\\\">Rechercher</span> <span ng-show=\\\"vm.isLoading\\\">Abracadabra ...</span></button></form><div><div class=\\\"clearfix\\\"><ngcart-summary ng-mouseover=\\\"showCart=true\\\"></ngcart-summary></div><ngcart-cart ng-show=\\\"showCart\\\" ng-mouseleave=\\\"showCart=false\\\"></ngcart-cart></div></div><div class=\\\"loader\\\" ng-show=\\\"vm.isLoading\\\"><div></div><div></div><div></div><div></div><div></div></div><div class=\\\"row\\\" masonry=\\'{ \\\"transitionDuration\\\" : \\\"0.4s\\\" , \\\"itemSelector\\\" : \\\".tile\\\"}\\' ng-if=\\\"vm.songs.resultCount !== 0\\\"><div class=\\\"col-xs-6 col-sm-4 col-md-3 tile\\\" masonry-tile=\\\"\\\" ng-repeat=\\\"song in vm.songs.results\\\"><div class=\\\"song\\\"><img ng-src=\\\"{{song.artworkUrl100}}\\\" alt=\\\"\\\"><div class=\\\"song-info\\\"><h2 class=\\\"song-title\\\">{{song.trackName}}</h2><h3 class=\\\"song-artiste\\\">{{song.artistName}}</h3><p class=\\\"song-price\\\">{{song.trackPrice | currency}}</p><p class=\\\"song-btn\\\"><ngcart-addtocart id=\\\"{{song.trackId}}\\\" name=\\\"{{song.trackName + \\' - \\' + song.artistName}}\\\" price=\\\"{{song.trackPrice}}\\\" quantity=\\\"1\\\"></ngcart-addtocart></p></div></div></div></div><div ng-if=\\\"vm.songs.resultCount == 0 && !vm.isLoading\\\" class=\\\"text\\\"><p class=\\\"error\\\" ng-show=\\\"vm.errorMsg != \\'\\'\\\">{{vm.errorMsg}}</p><p ng-show=\\\"vm.errorMsg == \\'\\'\\\">Si vous avez marre d\\'iTunes, on vous propose un nouveau store de musique avec exactement les mêmes résultats d\\'iTunes :)</p></div></div>\");}]);"],"sourceRoot":"/source/"}